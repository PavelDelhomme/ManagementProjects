{% load static %}

<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <title>{% block title %}{% endblock %} - Project Manager</title>
    <link rel="stylesheet" href="{% static 'fullcalendar/main.css' %}">
  </head>
  <body>
    {% if user.is_authenticated %}
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="{% url 'dashboard' %}">Tableau de bord</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'all_notifications' %}">Notifications ({{ request.user.notifications.unread.count }})</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'logout' %}">DÃ©connexion</a></li>
        </ul>
      </nav>
    {% else %}
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Connexion</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'signup' %}">Inscription</a></li>
        </ul>
      </nav>
    {% endif %}
    <div class="container-fluid">
    {% block content %}
    {% endblock %}
    </div>
    <script src="{% static 'fullcalendar-4.4.2/main.js' %}"></script>
    <script src="{% static 'fullcalendar-4.4.2/locales/fr.js' %}"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          events: [
            {% for project in projects %}
              {
                  title: "{{ project.name }}",
                  start: "{{ project.start_date }}",
                  end: "{{ project.end_date }}",
                  url: "{% url 'project_detail' project.pk %}"
              },
            {% endfor %}
            {% for task in tasks %}
              {
                  title: "{{ task.name }}",
                  start:"{{ task.start_date }}",
                  end:"{{ task.end_date }}",
                  url:"{% url 'task_detail' task.pk %}"
              },
        {% endfor %}
      ]
      });
        calendar.render();
      });
    </script>
    {% block scripts %}
    {% endblock %}
  </body>
</html>
